<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ product['name'] }} — Fashionista</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
  <header class="topbar">
    <div class="brand">fashionista</div>
    <div class="nav-actions">
      <a href="/cart">Cart (<span id="cartCount">0</span>)</a>
    </div>
  </header>

  <main class="product-page container">
    <div class="image-block">
      <img src="/static/images/{{ product['image'] }}" alt="{{ product['name'] }}" />
    </div>
    <div class="info-block">
      <h1>{{ product['name'] }}</h1>
      <p class="brand-name">{{ product['brand'] }}</p>
      <p class="price">₹ {{ '%.2f'|format(product['price']) }}</p>
      <p class="desc">{{ product['description'] }}</p>
      <p><strong>Sizes:</strong> {{ product.get('sizes','-') }}</p>
      <p><strong>Colors:</strong> {{ product.get('colors','-') }}</p>
      <label>Quantity <input id="qty" type="number" value="1" min="1" style="width:60px"></label>
      <div style="margin-top:10px">
        <button id="addBtn" class="btn primary">Add to cart</button>
        <button id="favBtn" class="btn">Add to favorites</button>
      </div>
    </div>
  </main>

  <script src="/static/js/main_v2.js"></script>
  <script>
    document.getElementById('addBtn').addEventListener('click', async ()=>{
      const qty = parseInt(document.getElementById('qty').value||1);
      const res = await fetch('/api/cart/add',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id:{{product['id']}},qty})});
      const j=await res.json();
      if(j.ok) alert('Added to cart');
      updateCartCount();
    });
    document.getElementById('favBtn').addEventListener('click', async ()=>{
      await fetch('/api/fav/toggle',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id:{{product['id']}}})});
      alert('Toggled favorite');
      updateFavCount();
    });
  </script>
</body>
</html>
